<!--
 - Created by Frederik on 11/21/2024.
 -->

<!-- Location Passport -->
<template>
  <lightning-card title="Location Passport" icon-name="standard:account">
    <!-- Account Details Section -->
    <div if:true={dataLoaded} class="slds-p-around_medium">
      <article class="slds-card slds-card_boundary">
        <div class="slds-card__header slds-grid">
          <header class="slds-media slds-media_center">
            <div class="slds-media__figure">
              <lightning-icon icon-name="standard:home" size="small"></lightning-icon>
            </div>
            <div class="slds-media__body">
              <h2 class="slds-card__header-title">General Information</h2>
            </div>
          </header>
        </div>
        <div class="slds-card__body slds-card__body_inner">
          <dl class="slds-list_horizontal slds-wrap">
            <dt class="slds-item_label slds-text-color_weak slds-truncate">Name:</dt>
            <dd class="slds-item_detail slds-truncate slds-text-heading_small">{accountData.Name}</dd>

            <dt class="slds-item_label slds-text-color_weak slds-truncate">Access Information:</dt>
            <dd class="slds-item_detail slds-truncate">{accountData.Access_Information__c}</dd>

            <dt class="slds-item_label slds-text-color_weak slds-truncate">Attention Points:</dt>
            <dd class="slds-item_detail slds-truncate">{accountData.Attention_points_for_execution__c}</dd>
          </dl>
        </div>
      </article>
    </div>

    <!-- Operating Hours Section -->
    <div if:true={slotsLoaded} class="slds-p-around_medium">
      <article class="slds-card slds-card_boundary">
        <div class="slds-card__header slds-grid">
          <header class="slds-media slds-media_center">
            <div class="slds-media__figure">
              <lightning-icon icon-name="standard:timesheet_entry" size="small"></lightning-icon>
            </div>
            <div class="slds-media__body">
              <h2 class="slds-card__header-title">Operating Hours</h2>
            </div>
          </header>
        </div>
        <div class="slds-card__body slds-card__body_inner">
          <template if:true={timeSlots.data}>
            <div class="custom-datatable">
              <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                <thead>
                <tr class="slds-line-height_reset">
                  <th class="slds-text-title_caps" scope="col">
                    <div class="slds-grid slds-grid_vertical-align-center">
                      <lightning-icon icon-name="utility:dayview" size="x-small" class="slds-m-right_x-small"></lightning-icon>
                      Day of Week
                    </div>
                  </th>
                  <th class="slds-text-title_caps" scope="col">
                    <div class="slds-grid slds-grid_vertical-align-center">
                      <lightning-icon icon-name="utility:clock" size="x-small" class="slds-m-right_x-small"></lightning-icon>
                      Start Time
                    </div>
                  </th>
                  <th class="slds-text-title_caps" scope="col">
                    <div class="slds-grid slds-grid_vertical-align-center">
                      <lightning-icon icon-name="utility:clock" size="x-small" class="slds-m-right_x-small"></lightning-icon>
                      End Time
                    </div>
                  </th>
                </tr>
                </thead>
                <tbody>
                <template for:each={timeSlots.data} for:item="slot">
                  <tr key={slot.Id}>
                    <td>{slot.DayOfWeek}</td>
                    <td>{slot.formattedStartTime}</td>
                    <td>{slot.formattedEndTime}</td>
                  </tr>
                </template>
                </tbody>
              </table>
            </div>
          </template>
        </div>
      </article>
    </div>

    <!-- Content Documents Section -->
    <div if:true={docsLoaded} class="slds-p-around_medium">
      <article class="slds-card slds-card_boundary">
        <div class="slds-card__header slds-grid">
          <header class="slds-media slds-media_center">
            <div class="slds-media__figure">
              <lightning-icon icon-name="standard:document" size="small"></lightning-icon>
            </div>
            <div class="slds-media__body">
              <h2 class="slds-card__header-title">Related Documents</h2>
            </div>
          </header>
        </div>
        <div class="slds-card__body slds-card__body_inner">
          <div class="slds-grid slds-wrap slds-gutters">
            <template for:each={contentDocuments.data} for:item="doc">
              <div key={doc.Id} class="slds-col slds-size_1-of-3 slds-p-around_xx-small">
                <article class="slds-card">
                  <div class="slds-card__header slds-grid slds-grid_vertical-align-center">
                    <header class="slds-media slds-media_center slds-has-flexi-truncate">
                      <div class="slds-media__figure">
                        <lightning-icon
                          icon-name={doc.iconName}
                          size="small">
                        </lightning-icon>
                      </div>
                      <div class="slds-media__body">
                        <h3 class="slds-truncate" title={doc.Title}>
                          {doc.Title}
                        </h3>
                      </div>
                    </header>
                  </div>
                  <div class="slds-card__footer">
                    <lightning-button
                      variant="brand"
                      label="View"
                      icon-name="utility:preview"
                      onclick={handleViewDocument}
                      data-id={doc.Id}
                      class="slds-m-left_x-small">
                    </lightning-button>
                  </div>
                </article>
              </div>
            </template>
          </div>
        </div>
      </article>
    </div>

    <!-- Feedback Section -->
    <div class="slds-p-around_medium">
      <article class="slds-card slds-card_boundary">
        <div class="slds-card__header slds-grid">
          <header class="slds-media slds-media_center">
            <div class="slds-media__figure">
              <lightning-icon icon-name="standard:feedback" size="small"></lightning-icon>
            </div>
            <div class="slds-media__body">
              <h2 class="slds-card__header-title">Feedback for Contract Manager</h2>
            </div>
          </header>
        </div>
        <div class="slds-card__body slds-card__body_inner">
          <div class="slds-grid slds-gutters slds-grid_vertical-align-center">
            <div class="slds-col slds-size_3-of-4">
              <lightning-textarea
                name="feedback"
                label="Feedback for Contract Manager"
                value={feedbackText}
                onchange={handleFeedbackChange}>
              </lightning-textarea>
            </div>
            <div class="slds-col slds-size_1-of-4 slds-p-top_medium">
              <lightning-button
                label="Post"
                variant="brand"
                icon-name="utility:share_post"
                onclick={handlePostFeedback}
                disabled={isPostDisabled}
                class="slds-m-left_x-small">
              </lightning-button>
            </div>
          </div>
        </div>
      </article>
    </div>

  </lightning-card>
</template>
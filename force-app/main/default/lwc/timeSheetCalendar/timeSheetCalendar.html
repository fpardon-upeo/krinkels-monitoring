<template>
  <div class="calendar-container">
    <template if:true={isLoading}>
      <lightning-spinner
        alternative-text="Loading"
        size="medium"
      ></lightning-spinner>
    </template>

    <div class="slds-modal__header">
      <h1
        id="modal-heading-01"
        class="slds-modal__title slds-hyphenate"
        tabindex="-1"
      >
        Daily Time Sheet
      </h1>
    </div>

    <div
      class="slds-modal__content slds-p-around_medium"
      id="modal-content-id-1"
    >
      <div class="fullcalendar"></div>
    </div>

    <div class="slds-modal__footer slds-docked-form-footer">
      <lightning-button
        label="Submit for Approval"
        variant="brand"
        onclick={handleSave}
      ></lightning-button>
    </div>
  </div>

  <!-- Modal -->
  <template if:true={showModal}>
    <section role="dialog" class="slds-modal slds-fade-in-open">
      <div class="slds-modal__container">
        <header class="slds-modal__header">
          <h2 class="slds-text-heading_medium">Create New Entry</h2>
        </header>
        <div
          class="slds-modal__content slds-p-around_medium slds-text-align_center"
        >
          <div class="slds-button-group" role="group">
            <lightning-button
              label="Time Sheet Entry"
              onclick={createTimeSheetEntry}
            >
            </lightning-button>
            <lightning-button
              label="Resource Absence"
              onclick={createResourceAbsence}
              class="slds-m-left_x-small"
            >
            </lightning-button>
          </div>
        </div>
        <footer class="slds-modal__footer">
          <lightning-button
            variant="neutral"
            label="Cancel"
            onclick={handleCloseModal}
          >
          </lightning-button>
        </footer>
      </div>
    </section>
    <div class="slds-backdrop slds-backdrop_open"></div>
  </template>

  <!-- New TimeSheetEntry Form -->
  <template if:true={showTimeSheetEntryNewForm}>
    <section class="slds-modal slds-fade-in-open">
      <div class="slds-modal__container">
        <header class="slds-modal__header">
          <h2 class="slds-text-heading_medium">New Time Sheet Entry</h2>
          <button
            class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
            onclick={handleCloseForm}
          >
            <lightning-icon
              icon-name="utility:close"
              alternative-text="Close"
            ></lightning-icon>
          </button>
        </header>
        <div class="slds-modal__content">
          <lightning-record-edit-form
            object-api-name="TimeSheetEntry"
            onsuccess={handleSuccess}
          >
            <lightning-messages></lightning-messages>

            <div class="form-fields">
              <!-- Add fields -->
              <lightning-input-field
                field-name="TimeSheetId"
                value={recordId}
                disabled
              ></lightning-input-field>
              <lightning-input-field
                field-name="StartTime"
              ></lightning-input-field>
              <lightning-input-field
                field-name="EndTime"
              ></lightning-input-field>
              <lightning-input-field field-name="Type"></lightning-input-field>
              <lightning-input-field
                field-name="Subject"
              ></lightning-input-field>
            </div>
            <!-- Submit and Cancel buttons -->
            <div class="slds-modal__footer slds-text-align_center">
              <lightning-button
                label="Cancel"
                variant="neutral"
                onclick={handleCloseForm}
              >
              </lightning-button>
              <lightning-button
                variant="brand"
                type="submit"
                label="Save"
              ></lightning-button>
            </div>
          </lightning-record-edit-form>
        </div>
      </div>
    </section>
    <div class="slds-backdrop slds-backdrop_open"></div>
  </template>

  <!-- New ResourceAbsence Form -->
  <template if:true={showResourceAbsenceNewForm}>
    <section class="slds-modal slds-fade-in-open">
      <div class="slds-modal__container">
        <header class="slds-modal__header">
          <h2 class="slds-text-heading_medium">New Absence Entry</h2>
          <button
            class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
            onclick={handleCloseForm}
          >
            <lightning-icon
              icon-name="utility:close"
              alternative-text="Close"
            ></lightning-icon>
          </button>
        </header>
        <div class="slds-modal__content">
          <lightning-record-edit-form
            object-api-name="ResourceAbsence"
            onsuccess={handleSuccess}
          >
            <lightning-messages></lightning-messages>

            <div class="form-fields">
              <!-- Add fields -->
              <lightning-input-field
                field-name="ResourceId"
                value={timeSheet.timeSheet.ServiceResourceId}
                disabled
              ></lightning-input-field>
              <lightning-input-field field-name="Start"></lightning-input-field>
              <lightning-input-field field-name="End"></lightning-input-field>
              <lightning-input-field field-name="Type"></lightning-input-field>
              <lightning-input-field
                field-name="Description"
              ></lightning-input-field>
            </div>
            <!-- Submit and Cancel buttons -->
            <div class="slds-modal__footer slds-text-align_center">
              <lightning-button
                label="Cancel"
                variant="neutral"
                onclick={handleCloseForm}
              >
              </lightning-button>
              <lightning-button
                variant="brand"
                type="submit"
                label="Save"
              ></lightning-button>
            </div>
          </lightning-record-edit-form>
        </div>
      </div>
    </section>
    <div class="slds-backdrop slds-backdrop_open"></div>
  </template>

  <!-- Edit TimeSheetEntry Form -->
  <template if:true={showTimeSheetEntryEditForm}>
    <section class="slds-modal slds-fade-in-open">
      <div class="slds-modal__container">
        <header class="slds-modal__header">
          <h2 class="slds-text-heading_medium">Edit Time Sheet Entry</h2>
          <button
            class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
            onclick={handleCloseForm}
          >
            <lightning-icon
              icon-name="utility:close"
              alternative-text="Close"
            ></lightning-icon>
          </button>
        </header>
        <div class="slds-modal__content">
          <lightning-record-edit-form
            object-api-name="TimeSheetEntry"
            onsuccess={handleSuccess}
            record-id={recordIdBeingHandled}
          >
            <lightning-messages></lightning-messages>

            <div class="form-fields">
              <!-- Add fields -->
              <lightning-input-field
                field-name="TimeSheetId"
                value={recordId}
                disabled
              ></lightning-input-field>
              <lightning-input-field
                field-name="StartTime"
              ></lightning-input-field>
              <lightning-input-field
                field-name="EndTime"
              ></lightning-input-field>
              <lightning-input-field field-name="Type"></lightning-input-field>
              <lightning-input-field
                field-name="Subject"
              ></lightning-input-field>
            </div>
            <!-- Submit and Cancel buttons -->
            <div class="slds-modal__footer slds-text-align_center">
              <lightning-button
                label="Cancel"
                variant="neutral"
                onclick={handleCloseForm}
              >
              </lightning-button>
              <lightning-button
                variant="brand"
                type="submit"
                label="Save"
              ></lightning-button>
            </div>
          </lightning-record-edit-form>
        </div>
      </div>
    </section>
    <div class="slds-backdrop slds-backdrop_open"></div>
  </template>

  <!-- Edit ResourceAbsence Form -->
  <template if:true={showResourceAbsenceEditForm}>
    <section class="slds-modal slds-fade-in-open">
      <div class="slds-modal__container">
        <header class="slds-modal__header">
          <h2 class="slds-text-heading_medium">Edit Absence Entry</h2>
          <button
            class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
            onclick={handleCloseForm}
          >
            <lightning-icon
              icon-name="utility:close"
              alternative-text="Close"
            ></lightning-icon>
          </button>
        </header>
        <div class="slds-modal__content">
          <lightning-record-edit-form
            object-api-name="ResourceAbsence"
            onsuccess={handleSuccess}
            record-id={recordIdBeingHandled}
          >
            <lightning-messages></lightning-messages>

            <div class="form-fields">
              <!-- Add fields -->
              <lightning-input-field
                field-name="ResourceId"
                value={timeSheet.timeSheet.ServiceResourceId}
                disabled
              ></lightning-input-field>
              <lightning-input-field field-name="Start"></lightning-input-field>
              <lightning-input-field field-name="End"></lightning-input-field>
              <lightning-input-field field-name="Type"></lightning-input-field>
              <lightning-input-field
                field-name="Description"
              ></lightning-input-field>
            </div>

            <!-- Submit and Cancel buttons -->
            <div class="slds-modal__footer slds-text-align_center">
              <lightning-button
                label="Cancel"
                variant="neutral"
                onclick={handleCloseForm}
              >
              </lightning-button>
              <lightning-button
                variant="brand"
                type="submit"
                label="Save"
              ></lightning-button>
            </div>
          </lightning-record-edit-form>
        </div>
      </div>
    </section>
    <div class="slds-backdrop slds-backdrop_open"></div>
  </template>
</template>